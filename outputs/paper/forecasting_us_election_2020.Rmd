---
title: "Joe Biden projected to win Popular Vote in 2020 US Election with 51% of Vote"
subtitle: "Data given with 4 percent margin of error"
author: "Alen Mitrovski, Xiaoyan Yang, Matthew Wankiewicz"
date: "November 2nd, 2020"
abstract: "It seems like everyone has been waiting for the 2020 election, almost as soon as Donald Trump won in 2016. In our report, we use a logistic regression model along with multilevel regression  with post-stratification in order to predict who will win the election. According to our model, we predict that Joe Biden will win the popular vote over Donald Trump, 51% to 49%. These results are promising for the people of the United States, as they may be getting the change in President they need."
output:
  bookdown::pdf_document2:
    citation_package: natbib
    includes:  
      in_header: my_header.tex
toc: FALSE
bibliography: references.bib
---

```{r setup, echo=F, message=F, warning=F}
#install.packages("tidyverse")
#install.packages("gtsummary")
#install.packages("statebins")
#install.packages("broom")
##install.packages("kableExtra")
library(tidyverse)
library(statebins)
library(broom)
library(kableExtra)
```

```{r files, echo=F, message=F, warning=F}
# |**Keywords:** Forecasting, US 2020 Election, Trump, Biden, multilevel regression with post-stratification;

# read in the polling data
polling <- readRDS("data/polling_data.rds")

# read in post-strat data 
post_strat <- readRDS("data/post_strat.rds")

# read in electoral colleges data
elec_college <- read_csv("data/electoral_colleges.csv")
elec_college$State <- tolower(elec_college$State)
```

**Keywords**: Forecasting, US 2020 Election, Trump, Biden, multilevel regression with post-stratification;

# Introduction

The 2020 United States presidential election will be on November 3rd, 2020. The Republican party is represented by, current president, Donald Trump. Likewise, former vice-president, Joe Biden is representing the Democratic party. This year’s election is particularly interesting due unforeseen circumstances of the COVID-19 pandemic and the civil unrest sparked by the killing of George Floyd.
 
For our report, we have looked at which candidate won the popular vote (ie. had the higher percentage of votes). In addition, we have calculated the total votes within each of the 50 American states in order to see how many points each candidate can accumulate for the electoral college. The electoral college is a system that was implemented in the United States to ensure that states with higher populations do not overwhelm the vote and provide greater power to individuals in historically smaller states (West). The presidential candidate with the most votes in a particular state wins all the electoral college votes for that state (West). The only exceptions to this rule are Nebraska and Maine who allocate their votes between both candidates based on the congressional district method (West). The electoral college has historically been viewed as a critical part of American democracy. However, it’s modern application has come into question in 2016 when Republican candidate Donald Trump won the election by accumulating the most electoral college votes despite losing the popular vote.
 
The survey data for this study was obtained from the Democracy Fund Voter Study Group; an organization that took the collaborative efforts of many scholars and analysts to get a better understanding of the evolving behavior of American voters (Voter Study Group). The post-stratification data for this study was obtained from the Integrated Public Use Microdata Series (IPUMS). IPUMS is an organization that provides survey and census data through the collaboration of 105 national statistical agencies (IPUMS). For the purpose of this report, we utilized the data from the 2018 American Community Survey. We selected state, race, age, sex, education level and whether an individual was Hispanic or not as key variables to use for the post-stratification of the dataset.
 
The following paper will outline the methods, data, results, discussion and weaknesses of the research. Our hypothesis is that Joe Biden will win the election based on the popular vote. Our null hypophysis is that Joe Biden will not win the election based on the popular vote. Our report is carried out using R (@citeR), and the library Tidyverse (@citeTidyverse) was used the most during the report.

# Data

We utilized the U.S.presidential election 2020 survey data from Nationscape conducted on June 25, 2020 as the study data to predict the 2020 election winner between Trump and Biden. The census data from IPUMS America Census Service was used as the post-stratification data for the survey data weighting adjustment. In the following sections, we will introduce the variable selection basis and the main data differences between the survey and the stratification data. 

## Survey Data

The survey data  was provided by Nationscape. Noationscape is a featured project of Democracy Fund Voter Study Group. Democracy Fund + UCLA Nationscape is one of the largest public opinion surveys ever conducted - interviewing people in nearly every county, congressional district, and mid-sized U.S. city in the leadup to the 2020 election [@citeVSG]. 
The survey data from June 25, 2020 was selected as the study data. It had 6479 responses and 265 variables.The survey was designed to cover age, gender, race, education, religion, remarks on Trump's performance in his first term, economy, propensity to the major political parties, their leaders, or candidates, ethnicity inequality, gun policy/issues, environment issues, green energy, health care/insurance, income tax, college tuition, abortion, international trade, immigration, legalize marijuana, and COV-19 pandemic.  Our goal is to select variables which can explain and predict the winner of the U.S. presidential election 2020 by applying a logistic multilevel regression model. It is crucial to understand the most important voting issues, especially the differences between Trump and Biden's supporters, and hence the selected variables must have the power to distinguish the two camps.

According to the research (@1) released on August 13, 2020, there are stark differences in how registered voters who support Donald Trump and Joe Biden view the importance of top voting issues. Foreign policy and Supreme Court appointments are comparable shares of Biden supporters and Trump supporters  view as very important. The top five voting issues from Trump supporters are economy (88%), violent crime (74%), immigration (61%), gun policy (57%), and foreign policy (57%). By contrast, the largest shares of Biden supporters view health care (84%), coronavirus outbreak (82%), and racial and ethnic inequality (76%) the top three voting issues. There are substantial differences between Trump and Biden supporters on the importance of most issues, the widest gaps are on climate change (57%) and racial and ethnic inequality (52%). Based on these facts, we selected age, gender, race, hispanic, education, and states as the explanatory variables in the model. A binary variable with values "Trump" or "Biden" was used as the respondent variable. The values were extracted from survey variable vote_2020. vote_2020 has 5 selections: "Donald trump", "Joe Biden", "I am not sure/don't know", "I would not vote", and "Someone else". We kept the data with "Trump" or "Biden" only and removed the remaining data with other selections. 
Age is one of the most important variables in our study. According to [@3], Americans age 45 and older comprise a plurality of 2020 eligible voters (at 56%) and actual voters (61%), estimated by applying 2016 turnout rates to 2020 eligible voters. Between 2012 to 2020, seniors' share (persons age 65 and older) of eligible voters rose from 17% to 23%, while their share of actual voters rose from 22% to 26% [@3]. From 2004 through 2016, these older groups showed a preference toward Republican candidates in presidential elections. But in the October 15 to 18, according to the New York Times/Siena College poll, they shifted toward Democrats [@3]. Comparing 2012 and 2016, the 2020 poll shows modest gains (from 13% and 14% to 17%) in favor of Democrats from the 18-to-44 age group. But for the 45-to-64 age group, the 2020 poll shows a Democratic swing of 7 and 11 points (from -4% and -8% to 3%) from previous elections. For the 65-and-older age group, the 2020 poll shows a Democratic swing of 23 and 18 points (from -12% and -7% to 11%) from previous elections. 

Another distinct feature of the 2020 election is that the young generation shows strong willingness to vote. According to [@2], 51% of registered voters ages 18 to 34 say that they are extremely or very enthusiastic to vote in 2020, compared to the 30% of registered voters in that age group who said the same in 2016. Likewise, a preview of the Harvard Institute of Politics Fall 2020 Youth Poll [@2] found that 63% of young Americans say they will "definitely" vote in November as compared to the 47% who said the same in 2016. Overall, the results of Harvard's survey project the highest youth voter turnout in 12 years. Based on our research, we divided the age group into 4 categories: <=35, 36-50, 51-65, and 65+. We believe these four categories should have strong differential power for voting issues concentrated on different age groups. 

Another important variable is race. In the survey data, variables race_ethnicity and Hispanic represent people with no Hispanic and Hispanic background respectively. Variable race_ethnicity includes 6 categories and 15 options. The five categories include "White", "Black, or African American","American Indian or Alaska Native", "Asian", "Pacific Islander", and "Some other race". "Asian" category includes 7 options: "Chinese", "Japanese", "Asian Indian", "Filipino", "Korean", "Vietnamese", and "Other". According to [@4], More than 11 million Asian Americans will be able to vote in 2020, making up nearly 5% of the nation’s eligible voters (for this analysis, U.S. citizens ages 18 and older).The estimated number of Native Hawaiian and Other Pacific Islander alone-or-in-combination residents of the United States in 2018 is 1.6 million [@5]. There is no research results or evidence to show that within Asian or Pacific Islander communities, specific voting issues have split voters into opposing tendencies. We decided to merge "Asian" and "Pacific Island" to one option. In the end, we have four options for the race variable: "white", "black", "asian", and "other race, nec"

People with Hispanic heritage were classified to have a separate variable Hispanic. In the survey data,Hispanic was subdivided into 15 groups. In 1976, the U.S. Congress passed the only law in this country’s history that mandated the collection and analysis of data for a specific ethnic group: Americans of Spanish origin or descent. The language of that legislation described this group as “Americans who identify themselves as being of Spanish-speaking background and trace their origin or descent from Mexico, Puerto Rico, Cuba, Central and South America, and other Spanish-speaking countries.” This includes 20 Spanish-speaking nations from Latin America and Spain itself, but not Portugal or Portuguese-speaking Brazil. Standards for collecting data on Hispanics were developed by the Office of Management and Budget in 1977 and revised in 1997. However, the Census Bureau does not apply this definition when counting Hispanics. Rather, it relies entirely on self-reporting and lets each person identify as Hispanic or not [@6]. The U.S. Hispanic population reached a record 60.6 million in 2019, up 930,000 over the previous year and up from 50.7 million in 2010, according to newly released U.S. Census Bureau population estimates.Between 2010 and 2019, the Latino share of the total U.S. population increased from 16% to 18%. Latinos accounted for about half (52%) of all U.S. population growth over this period. They are the country’s second largest racial or ethnic group, behind white non-Hispanics.[@8]. In 2019, the top fives states which have the most Hispanic populations are California (15.57 million), Texas(11.52 million), Florida (5.66 million), New York(3.75 million), and Arizona (2.31 million) [@10]. Professor Raul Madrid in the Department of Government at UT who specialized in latino American politics said "Cubans are traditionally more conservative, more likely to vote Republican. Mexicans are more liberal, more likely to vote Democrat. The same is true of Puerto Ricans. Central Americans in general tend to vote more Democrat. But whereas some people from some South American countries like Venezuela tend to be more conservative" [@11]. Based on the findings stated above, we aggregated hispanic into five groups: "no hispanic", "mexican", "puerto rican", "cuban", "other".

Gender plays an important role in U.S. presidential elections. Although the constitution was amended in 1920 to give women the right to vote, women were discouraged by their families from participating in politics for decades. The situation changed in the baby boomer generation. Women grew up expecting a college education and a work-life outside the home. In 1980, with the nomination of Reagan for president, the Republic Party moved sharply to the right on a handful of issues relevant to women. The party dropped into support of the Equal Rights Amendment, embraced an anti-abortion position, and courted conservative Christians who lamented the effect of working women on "traditional" families[@pewexam]. In the next few decades, conservative elites sorted into the republican Party, while liberal elites sorted into the Democratic Party. Voters followed. This alignment had specific ramification for the gender gap. Men had consistently held more conservative positions than women on a range of issues. As the parties became more ideological the gender gap kept growing-from 8% in 1980 to 12% in 2000, to 13% in 2016 [@pewexam].Back to 2020 presidential election, the pollings conducted by multiple polling organizations from June 2, 2020 to October 27, 2020 have shown that women presented strong gender gap in favoring Biden. The Center for American Women and Politics (CAWP) is tracking gender differences in support for the major party candidates in the 2020 presidential election at the national level and in battleground states [@12]. The polling results show that at the national level, women had consistent support to Biden over Trump. The difference ranged from 8% to 15%. However, in the battleground states, the difference was not obvious. From June 8, 2020 to October 28, 2020, 81 polls were conducted in the battleground states. 3 pollings show (-2% OH,-3% Tex, -1% OH) of women who less favored Biden. 6 polling results were flat. The remaining results were that women voted Biden over Trump. Gender is definitely a winner of variables in our model.

The education gap is an important factor shaping two distinct and increasingly antithetical worldviews in the USA. In the 2016 election. whites with a four-year college degree or more education made up 30% of all validated voters. Among these voters, far more (55%) said they voted for Clinton than for Trump (38%). Amount the much larger group of white voters who had not completed college (44% of all voters),Trump won by more than two-to-one(64% to 28%) [@12].But many pollsters did not adjust their samples - a process known as weighting - to make they had the right number of well-educated or less educated respondents. Well-educated  voters are much likelier to take surveys than less educated ones. About 45% of respondents in a typical national poll of adults will have a bachelor's degree or higher [@13]. According to the US education attainment census [@13], in 2019, high school was the highest level of education completed by 28.1% of the population age 25 and older and 22.5% finished four years of college. 36% of the population age 25 and older with a bachelor's degree or higher. 
In the survey data, education was grouped into "3rd Grade or less", "Completed some high school", "High school graduate", "Other post high school vocational training", "Completed some college, but no degree", "Associate Degree", "College Degree (such as B.A, B.S", "Completed some graduate, but no degree", "Masters degree", and "Doctorate degree" 11 groups. We regrouped education into "High school or lower", Completed some college, but no degree", and "Post Secondary or Higher" three groups to suit our model. The weights for these three groups are 28.94%, 20.15%, and 50.90% respectively. 50.90% is much higher than the census data 36%. The gap will be adjusted in the post-stratification procedure.

## Post-Stratification Data

The post-stratification data was downloaded from IPUMS America Census Service (ACS). The ACS is a project of the U.S. Census Bureau that has replaced the decennial census as the key source of information about American population and housing characteristics. The IPUMS database contains samples from the 2000-2019 ACS [@citeIPUMS]. We assumed the census data approximated the true distribution of the U.S. population and selected the most recent ACS 2018 data as the post-stratification data set.

The post-stratification has 2,543,459 records. To maintain unity with the survey data, we selected age, gender, race, hispanic, education as the target variables. We cleaned and regrouped these variables to align with the survey data. Figures 1 and 2 show the corresponding variable comparisons between the survey and the post-stratification data. Solid line and dot line represent the survey and the post-stratification data respectively. The differences in the following paragraphs are the absolute differences.
For the age group comparisons, the weights for 50-65 groups are very close. The survey data over represents the 18-35 and 36-49 groups. The discrepancies are 3.2% and 7.9% respectively. On the other hand, the senior group (65+) the survey data is under represented. The difference is 8.2%.
The gender comparisons do not show large differences. The differences are within 2%. For the Hispanic and non-Hispanic population comparison, the weights are almost the same. For the non-Hispanic population, the percentages for white are very close. The difference is 3.3%, the white population is under represented in the survey data. Black population is slightly over-represented in the survey data. The difference is 1.4%. The Asian weight in the survey is slightly less than the post-stratification data. The difference is 1.9%. For the population in other race category, the weight in the survey data is 3.8% higher than the weight in the post-stratification data.
Education is the main adjustment in the post-stratification procedure. For the post secondary or higher education group, the weight is 12.1% over represented in the survey data. For the high school or lower group, the survey data is 10.4% lower than the post-stratification data. The weights are close for the some post secondary group from the two data sets. These observations further proved that well-educated voters are much likelier to take surveys. According to surveys and 2016 election results, voters with four-year college degrees or more education have higher propensity to vote for Biden. The population who have not completed college has a higher percentage to support Trump. 
The last graph in Figure 2 illustrates the population weights by states. Overall, the curves present very similar patterns. In most states, the weights are very close. The noticeable gaps are in Florida, New York, and Texas.The survey data over represent the weights in Florida and New York by 1.5% and 2.8% respectively. In Texas, the survey data presents the population by 1.1% compared with the post-stratification data. 
In general, by comparing with the survey data and the post-stratification data, the largest gap is in education variables. Age ranks the second one. The other variables do not show large percentage discrepancies between the two data sets. The post-stratification method is applied to make the survey results more representative for the whole population.



We have used R (@citeR), specifically Tidyverse (@citeTidyverse) for data analysis

Data is from ACS (@citeIPUMS) and from Voter Study Group (@citeVSG).

```{r data1, echo=F, message=F, warning=F, fig.cap="Demographics of Sample and Population"}

# set up proportions and plots for polling data (variables we focus on)
# we do this by grouping by variable, getting the number of observations
# and then finding the percentage and classifying if they are polling or 
# post-strat data

# we do this grouping for gender, race, education level, state, age and 
# whether the respondent is hispanic or not
gender <- polling %>% 
  group_by(sex) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "poll",
         group = "gender") %>% 
  rename(level = sex)

races <- polling %>% 
  group_by(races) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "poll",
         group = "races") %>% 
  rename(level = races)

education <- polling %>% 
  group_by(education_level) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "poll",
         group = "education") %>% 
  drop_na(education_level) %>% 
  rename(level = education_level)

age <- polling %>% 
  group_by(age_groups) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "poll",
         group = "age") %>% 
  rename(level = age_groups)

statesicp <- polling %>% 
  group_by(stateicp) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "poll",
         group = "state") %>% 
   rename(level = stateicp)

hispanic <- polling %>% 
  group_by(hispanic) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "poll",
         group = "hispanic") %>% 
   rename(level = hispanic)

# set up proportions for post-strat data

# follow the same steps as above

gender_post <- post_strat %>% 
  group_by(sex) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "post-strat",
         group = "gender") %>% 
  rename(level = sex)

races_post <- post_strat %>% 
  group_by(races) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "post-strat",
         group = "races") %>% 
  rename(level = races)

education_post <- post_strat %>% 
  group_by(education_level) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "post-strat",
         group = "education") %>% 
  rename(level = education_level)

age_post <- post_strat %>% 
  group_by(age_groups) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "post-strat",
         group = "age") %>% 
  rename(level = age_groups)

statesicp_post <- post_strat %>% 
  group_by(stateicp) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "post-strat",
         group = "state") %>%
  rename(level = stateicp)

hispanic_post <- post_strat %>% 
  group_by(hispanic) %>% 
  summarise(n = n()) %>% 
  mutate(pct = n/sum(n), type = "post-strat",
         group = "hispanic") %>% 
  rename(level = hispanic)

# combine all of our grouped data into one data set
# called variables

variables <- rbind(hispanic, hispanic_post,
             age, age_post, gender, gender_post, 
             races, races_post)

# finally plot our results, grouped by variable with each line representing
# the proportions for the polling and post-strat data

variables %>% ggplot(aes(as.factor(level), pct, group=as.factor(type), linetype = as.factor(type))) + 
  geom_line() + facet_grid(~group, scales = "free") + 
  theme(axis.text.x = element_text(angle=70, size = 6, hjust = 1)) +
  labs(x = "Category", y = "Proportion", linetype = "data set") + 
  scale_y_continuous(labels = scales::percent) +
  geom_hline(yintercept = 0.5, alpha = 0.35)
```

Figure \@ref(fig:data1) show us the voter demographics from the VSG data (@citeVSG) vs the ACS data (@citeIPUMS).

```{r data2, echo = F, message=F, warning=F, fig.cap="More Demographics of Sample and Population"}
# combine educationa and state into one data set, need to separate these
# because text overlaps and makes the data look cleaner

variables2 <- rbind(education, education_post,
                    statesicp, statesicp_post)

# plot our results, grouped by variable with each line representing
# the proportions for the polling and post-strat data

variables2 %>% ggplot(aes(as.factor(level), pct, group=as.factor(type), linetype = as.factor(type))) + 
  geom_line() + facet_wrap(~group, nrow = 2, scales = "free") + 
  theme(axis.text.x = element_text(angle=70, size = 6, hjust = 1)) +
  labs(x = "Category", y = "Proportion", linetype = "data set") +
  scale_y_continuous(labels = scales::percent)
```

Figure \@ref(fig:data2) shows us more of the voter demographics from the VSG data (@citeVSG) vs the ACS data (@citeIPUMS).

```{r polling props, echo=F, message=F, warning=F}
# group the proportion of respondents by whether they'll vote for
# Biden or Trump

polling_vote <- polling %>% 
  mutate(vote_biden_clean = ifelse(vote_biden == 1, "Joe Biden", "Donald Trump")) %>% 
  group_by(vote_biden_clean) %>% 
  summarise(n = n()) %>%
  mutate(Proportion = round(n/sum(n)*100))

# rename the columns to make it more presentable

polling_vote <- polling_vote %>% 
  rename("Candidate" = vote_biden_clean,
         "Number of Respondents" = n,
         "Proportion (%)" = Proportion)

# plot the table along with number of respondents and proportions

kable(polling_vote, 
      caption = "Who decided voters plan to support (Polling Data)")
```

Table \@ref(tab:polling props) shows the proportion of decided voters who plan to vote for Donald Trump or Joe Biden. The data used to create this table is from the Voter Study Group (@citeVSG). 

# Model

For our analysis, we plan to use multilevel regression with post-stratification. Multilevel regression with post-stratification (MRP) is a type of analysis where we fit a model using a smaller data set, in this case our polling data and then use the results of the model to apply it to a larger population.

The main steps for MRP are: Find the data set you want to use to create your model. For our scenario, we used the polling data from the Voter Study Group (@citeVSG). Next, you must create a model using your smaller sample. We used logistic regression and the data used was the polling data. Our equation takes the form of equation \@ref(eq:logit), as seen below. Once you have your model, you must apply it to your larger data set to give an idea of the population. For our report, we used the Census data from IPUMS (@citeIPUMS).

MRP is extremely useful not only because of how simple it is but also because it allows us to estimate preferences of a population using individual responses from surveys. Also, as Kennedy and Gelman discuss in their paper "Know your population and know your model: Using model-based regression and post-stratification to generalize findings beyond the observed sample", MRP works best when you have a population and variables of interest and want to apply these variables using two data sets with different characteristics (@kennedy_gelman). Also, in relation to surveys, since you only use one survey to create your model, you don't encounter issues with having to have multiple surveys for each region/state and lets under-sampled populations to be represented through post-stratification. 

MRP does encounter some weaknesses as well. Once again we can look to Kennedy and Gelman's paper where they say that MRP is dependent on how accurate the model is (@kennedy_gelman). If the generated model makes incorrect predictions or assumptions, your post-stratification will be incorrect and will hurt your results.

To predict whether or not a person plans to vote for Joe Biden or Donald Trump, we plan to build a logistic regression model using data from the Voter Study Group (@citeVSG) and then post-stratify it using Census Data (@citeIPUMS). Since logistic regression only works for binary response variables, we created a variable called `vote_biden` which returns a 1 is the respondent plans to vote for Joe Biden and a 0 if they plan to vote for Donald Trump.

The logistic regression model takes the form of:

\begin{equation} 
  log(\frac{\hat{p}}{1 - \hat{p}}) = \beta_{0} + \beta_{1}x_{sex} + 
\beta_{2}x_{agegroup} + \beta_{3}x_{race} + \beta_{4}x_{state} + \beta_{5}x_{income} + \beta_{6}x_{hispanic}
  (\#eq:logit)
\end{equation} 

Once we have our regression model, we will use the `predict` function in R (@citeR), to apply our model to the Census data (@citeIPUMS). We do this by grouping the Census data by the demographics we plan to analyze (sex, race, age, education level, hispanic or not, state), and then applying the model to each of those groups. After applying the model, we will receive probabilities that a person in that group will vote for Joe Biden. Once the predictions are complete, we can use them to find out who will win the popular vote or how many electoral colleges a candidate will win. We also can use a 95 percent confidence interval, which means that we are 95 percent certain that true value for the population (in this case popular vote percentage), is within the range we obtain. From this we can also conclude that our results will be accurate between +/- 4%. 

In equation \@ref(eq:logit), each $\beta$ represents a coefficient that the regression model will compute for us. As for our variables, we have chosen to use sex, age, race, income, state, and whether the respondent is hispanic. We decided to use the first 3 because they are generally strong predictors of which candidate a person would support, such as how some states tend to vote republican year after year while some states flip between democratic and republican almost every election. Next, we decided to choose income, because Joe Biden has made claims to increase taxes on the rich, which may influence their support for him. Lastly, we wanted to focus on whether the respondent was hispanic and if so, where they were from. This variable was important for our predictions because we know how poorly Donald Trump has spoken of hispanic people and we believe they could have a strong impact on the election.

The output of the logistic regression model will give us a probability of whether or not a voter plans to vote for Joe Biden or not. In order to find this probability, we take the sum of the right side of equation \@ref(eq:logit) and plug it into the equation below:

\begin{equation} 
  \frac{e^{sum}}{1+e^{sum}}
  (\#eq:prob)
\end{equation} 

Equation \@ref(eq:prob) is just a manipulation of equation \@ref(eq:logit), where $e$ is the exponential equation and $sum$ is the sum of the right side of equation \@ref(eq:logit). We see that as the sum of the right side increases, the probability that a person will vote for Joe Biden increases as well. 
We are running our regression model using the `glm()` function in R (@citeR). The decision to run this model over other models like linear regression was made by the fact that we were predicting a binary variable about a voter's decision. Since there are only two possible options our data will likely follow an S shape and a straight line equation will not be helpful to model this relationship. Another strength present for logistic regression is that when combined with post-stratification it allows us to take information from under-represented populations and it allows their views to be accounted for more greatly. For example, our polling data (@citeVSG), includes only 2 observations from Wyoming, but using multilevel regression with post-stratification, we can have that expanded to over 3000 people!

Our model does have some weaknesses, since the output must be binary, we cannot account for other candidates or a person deciding not to vote. This issue isn't too large because our main goal is to determine which of the two main candidates will be chosen by the people of America. Another weakness we do encounter with our model and multi level regression with post-stratification is that it has a strong dependence on the survey data. This is a weakness because if the survey has any gaps or there are any tweaks we need to make, it can change the course of results.

```{r model, echo = F, message=F, warning=F, fig.cap="Results of Regression Model"}
#run the regression model using glm.
# sex, age_groups, race, stateicp, education_level and hispanic are used to 
# predit whether a person will vote biden or not

model <- glm(vote_biden ~ sex + age_groups + races +
               stateicp + education_level + hispanic, 
             data = polling, family = binomial())

# save the coefficients along with the confidence intervals,
# will be useful for our figures

coefficients <- broom::tidy(model, conf.int = T)

# create a table with the results of our coefficients along with p-values and
# confidence intervals

knitr::kable(coefficients,
             caption = "Coefficients from the Model") %>% 
  kableExtra::kable_styling(latex_options = "scale_down")
```


Table \@ref(tab:model), shows the estimates for the coefficients that will fit into our logistic regression equation. These coefficients will fit into Equation \@ref(eq:logit), and were calculated using data from the Voter Study Group (@citeVSG). The table is made using `kable` from `knitr` (@citeKnitr) and is formatted using `kableExtra` (@citekableExtra)

```{r coefficients, echo=F, message=F, warning=F, fig.height=4, fig.cap="Coefficient Estimates"}
# plot our coefficients with error bars to show the upper and lower
# estimates for the coefficients

coefficients %>% ggplot(aes(estimate, term)) +
  geom_point() +
  geom_errorbar(aes(xmin = conf.low, xmax = conf.high)) +
  labs(title = "Coefficient Estimates",
       x = "Estimate", y = "Coefficient") +
  theme(axis.text.y = element_text(size = 5))
```

Figure \@ref(fig:coefficients) shows us the coefficients that would fit into equation \@ref(eq:logit) using the polling data (@citeVSG). We also have error bars present, which show the upper and lower estimates for the coefficients. What we have to look out for in this scenario is that coefficients with negative values would mean that the person is more likely to vote for Donald Trump (with that characteristic) and positive values mean the person is more likely to vote for Joe Biden. Table \@ref(tab:model) shows a numerical view of Figure \@ref(fig:coefficients), along with p-values. 

Using the outputs of the logisitic regression model, we can get an equation that follows the form of \@ref(eq:logit), but with the $\beta$ values filled out. This equation is difficult to write out because of the many variables, but in short, if the person's characteristic fits in with a certain variable, it is used in the equation. Then the equation is summed up and the probability is found using equation \@ref(eq:prob).

```{r cooks, echo=F, message=F, warning=F, fig.cap="Cook's Distance Plot for Model"}
# create a plot for cook's distance for the model, numbering the 3
# highest distances
plot(model, which = 4, id.n = 3)
```

Figure \@ref(fig:cooks) shows the cooks distance for observations in our polling data set. Cook's distance is useful for checking if a model is working correctly because it tells us how far a point is from the predicted value of it, telling us which points negatively impact our model. In our scenario, the distance between values would be the true value using our `glm` model vs what the `predict.glm` function returned. Figure \@ref(fig:cooks) takes all observations of our polling data (@citeVSG), and calculates the Cook's distance for it, showing which points can hurt the results of our model. We find that out of the 5200 obsevations, there aren't too many points that deviate from what we predict. This makes sense for our model because in the real world, there are some people who will support Donald Trump or Joe Biden, even if they don't "fit" the usual voter demographic for the candidate. Since the number of observations with large Cook's Distances are low, we can conclude that our model is fairly strong.

# Results

```{r prediction, echo=F, warning=F, message=F}
# get proportions by demographic, then find proportion of each cell relative to population
props <- post_strat %>% 
  group_by(stateicp, races, age_groups,
           sex, education_level, hispanic) %>% 
  summarise(n = n()) %>% 
  group_by(stateicp) %>% 
  mutate(prop = n/sum(n))

# generate predictions for each of our grouped cells
props$estimate <- predict.glm(model, newdata = props,
                          type = "response")

# create a new column with number of voters from each cell voting Biden
props <- props %>% mutate(num_voters = n*estimate)

# get errors for our prediction
errors <- predict.glm(model, newdata = props,
                      type = "response", se.fit = T)
lower <- errors$fit - errors$se.fit
upper <- errors$fit + errors$se.fit


# combine the proportions and the errors we generated
props_error <- cbind(props, lower, upper)
props_error <- props_error %>% 
  rename("lower" = ...11,
         "upper" = ...12)

# create a new column with number of voters from each cell voting Biden
props_error <- props_error %>% mutate(num_voters_lower = n*lower,
                                num_voters_upper = n*upper)

# create a new dataset which contains upper and lower estimates for proportions
# of votes for each state
voting_biden <- props_error %>% mutate(biden_predict_prop=estimate*prop,
                                       biden_predict_prop_lower = lower*prop,
                                       biden_predict_prop_upper = upper*prop) %>%
  group_by(stateicp) %>%
  summarise(biden_predict = sum(biden_predict_prop),
            biden_predict_lower = sum(biden_predict_prop_lower),
            biden_predict_upper = sum(biden_predict_prop_upper))
```



```{r stateplot, echo=F, message=F, warning=F, fig.cap="Proportion of each State Voting for Biden"}
# get state by state proportions for our polling data
polling_props <- polling %>% 
  group_by(stateicp, vote_biden) %>% 
  summarise(n = n()) %>% 
  mutate(prop = n/sum(n)) 

# combine the polling data proportions with the post-stratification data
poll_post_biden <- inner_join(polling_props, voting_biden, by = "stateicp")
poll_post_biden <- poll_post_biden %>% 
  filter(vote_biden == 1)

# plot for predictions

poll_post_biden %>% 
  ggplot(aes(x = stateicp, y = biden_predict)) +
  geom_point(aes(color = "black")) +
  geom_line(aes(group = 1)) +
  scale_y_continuous(labels = scales::percent) +
  theme(axis.text.x = element_text(angle = 70, size = 6, hjust = 1)) +
  geom_ribbon(aes(group = 1, ymin=biden_predict_lower, ymax=biden_predict_upper), 
              alpha = 0.2, fill = "red") +
  geom_line(data = poll_post_biden, aes(x=stateicp, y=prop, group = 2), 
            linetype = "twodash") +
  geom_point(data = poll_post_biden, aes(x=stateicp, y=prop, colour = "red")) +
  geom_hline(aes(yintercept = 0.5), alpha = 0.5) +
  scale_color_discrete(name = "Data", labels = c("Population", "Sample")) +
  labs(title = "Proportion of People voting for Joe Biden by State",
       x = "State", y = "Percentage Voting Biden")
```


Figure \@ref(fig:stateplot) shows us the proportion of respondents voting for Joe Biden broken down by state, along with the predicted proportions using MRP. We have also included the errors for each predicted value as well. We can see that the predicted proportions are fairly close to what the polling data showed. But, we also have to acknowledge the errors present, we can see that many states' errors cross over the 50% line which could be pivotal for each candidate because of the winner take all nature of the electoral college. We can see that some states like Florida and Georgia have small errors but there are some states who have very large ones like North Dakota and Wyoming.

```{r statemap, echo=F, message=F, warning=F, fig.cap="Proportion of Voters from Each State Voting Joe Biden"}
# plot state map

voting_biden %>% 
  mutate(statename = str_to_title(stateicp)) %>% 
  ggplot(aes(fill = biden_predict, state = statename)) + 
  geom_statebins() + 
  scale_fill_gradient2(low = "#d12531", high = "#244999",
                       mid = "white", midpoint = mean(voting_biden$biden_predict)) +
  theme_classic() +
  theme(axis.line = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank()) +
  labs(fill = "Proportion Voting \nfor Biden",
       title = "Map of the USA and which states plan to support Joe Biden or Donald Trump")
```

Figure \@ref(fig:statemap) is an amazing view of all the states and which candidate they are leaning towards voting for using `statebins` (@citeStatebins). We see that states like Vermont, Conneticut and California are some of the more "blue" states, meaning they plan to vote for Joe Biden, while North Dakota, Arkansas and Idaho are the "red" states, planning to vote for Donald Trump. The states that are more white in colour can be the most important for the race when it comes to deciding an actual winner through the electoral college. We see that Florida, Louisiana and New Hampshire are some of the more undecided states, and a switch in these states, can influence the election greatly.

```{r colleges, echo=F, message=F, warning=F}
# merge our electoral college data with predictions from model
states_biden_prop <- voting_biden %>%
  rename("State" = stateicp)
states_college <- inner_join(states_biden_prop, elec_college, by = "State")

# create new variables finding the upper, lower and mean prediction for number of colleges
states_college <- states_college %>% 
  mutate(biden_colleges = case_when(
    State == "Nebraska" ~ round(biden_predict*Number_of_colleges),
    State == "Maine" ~ round(biden_predict*Number_of_colleges),
    State != "Maine" | State != "Nebraska" ~ ifelse(biden_predict >= 0.5, Number_of_colleges, 0)
  ),
  biden_colleges_lower = case_when(
    State == "Nebraska" ~ round(biden_predict_lower*Number_of_colleges),
    State == "Maine" ~ round(biden_predict_lower*Number_of_colleges),
    State != "Maine" | State != "Nebraska" ~ ifelse(biden_predict_lower >= 0.5, Number_of_colleges, 0)),
  biden_colleges_upper = case_when(
    State == "Nebraska" ~ round(biden_predict_upper*Number_of_colleges),
    State == "Maine" ~ round(biden_predict_upper*Number_of_colleges),
    State != "Maine" | State != "Nebraska" ~ ifelse(biden_predict_upper >= 0.5, Number_of_colleges, 0)))


# compile upper, lower and mean number of colleges won, plus proportion of popular vote 
biden_upper <- c(round(sum(states_college$biden_colleges_upper)), 
                 (round(100*sum(props_error$num_voters_upper)/sum(props_error$n),1)))
biden_mid <- c(round(sum(states_college$biden_colleges)), 
                 (round(100*sum(props_error$num_voters)/sum(props_error$n), 1)))
biden_lower <- c(round(sum(states_college$biden_colleges_lower)), 
                 (round(100*sum(props_error$num_voters_lower)/sum(props_error$n), 1)))

# create a dataframe with all three estimates and create a table displaying the estimates
estimates <- tibble("Lower Estimate" = biden_lower, "Mean Estimate" = biden_mid, "Upper Estimate" = biden_upper)
rownames(estimates) <- c("Number of Colleges", "Proportion of Vote (%)")
kable(estimates, caption = "Joe Biden Voting Result Estimates") %>% 
  kable_styling(latex_options = "scale_down")
```

Table \@ref(tab:colleges) shows the lower, mean and upper predictions for the results of the election for Joe Biden. We see that on the lower end, Biden can expect to get 46.1% of the popular vote while only getting 191 electoral colleges. We also see that our middle estimate says Biden will get 51% of the popular vote while still losing the election by getting only 260 colleges. Lastly, on the upper estimate for Biden's results, he can get 55.9% of the popular vote while getting 423 colleges! This truly shows how close this election is, as we can see in Figure \@ref(fig:stateplot), many states are hovering around the 50% mark, which shows the colleges can go either way. The number of electoral colleges by state were found on the Britannica Encylopedia's website (@colleges).

```{r votingscales, echo=F, message=F, warning=F, fig.cap="Proportion of Biden votes by state"}
# arrange our proportions for each state in descending order

stateprops_plot <- poll_post_biden %>% arrange(desc(biden_predict)) %>% 
  mutate(support = ifelse(biden_predict >= 0.5, "Biden", "Trump"))

# plot the results, with a line on 50% because of the electoral college

stateprops_plot %>% ggplot(aes(y = reorder(stateicp, biden_predict), x = biden_predict, 
                               color = support)) +
  geom_point(stat = "identity") +
  geom_errorbar(aes(xmin = biden_predict_lower, xmax = biden_predict_upper)) +
  geom_vline(xintercept = 0.5, linetype = "dashed", color = "red") +
  labs(title = "Estimated Proportion of State Voting for Joe Biden",
       x = "Percentage", y= "State") +
  scale_x_continuous(labels = scales::percent) +
  theme(axis.text.y = element_text(size = 5)) +
  scale_color_manual(values = c("Blue", "Red"))
```

Figure \@ref(fig:votingscales) is a different view of Figure \@ref(fig:stateplot), this time only focusing on the predictions for each state with the errors included. We see that many states have error bars overlapping the 50% line, showing that many states are a toss up, given the nature of the electoral college. 

# Discussion

As seen in table 1, the mean estimate is that Joe Biden will win the popular vote with 51% of the vote. This means that we reject the null hypothesis. However, the American election operates according to the electoral college and as such, it is possible that a candidate wins the popular vote but loses the electoral college. This has happened on two occasions: in 2000 when Al Gore lost to George W. Bush and in 2016 when Donald Trump won over Hillary Clinton (@cbc). According to our results, Biden would win the popular vote but lose the electoral college vote with a mean estimate of 260 points (270 is the threshold for victory). The abolishment of the electoral college has been considered, however, professor Opal from McGill university notes that it would require a constitutional amendment to pass this unlikely change (@cbc).
 
Through Figure 5, we are able to visualize numerous national trends of voting behavior. First, it is observable that Joe Biden and the Democrats have a strong hold of the west coast states. However, this was not always the case. Up until 1988, the Republican consistently had the support of California voters, who make up 55 electoral college points (@krishnakumar). However, California had a massive spike in Hispanic and Asian immigrants during the 1990’s (@krishnakumar). This growing voter base was put off by the anti-immigration stance of the Republican party; Particularly in 1994, when the Republican’s attempted to pass a law that would deny public services to illegal immigrants (@krishnakumar). As a result of information, it comes as no surprise that Biden has a strong lead in California in our data and collects the 55 electoral college points.
 
Secondly, based on Figure 5, Republican party leader Donald Trump performs very well in the American mid-west. This would follow-up Trump’s 2016 victory in the historically democratic states of Iowa, Ohio, Michigan and Wisconsin (@lauck). Many of these states had not voted Republican since the 80’s and were considered pillars of the Democratic voter base (@lauck). However, blue-collar workers in these states have flipped their vote over their dissatisfaction of the economy and manufacturing sector under Democratic leadership (@wilson). Considering the importance of an improving economy to mid-west voters, the economic growth under the Trump administration should lead to another set of victories in this part of America (@bbc). This information would explain the results in our data for these mid-west states.
 
Thirdly, as seen in Figure 5, Joe Biden seems to possess a strong lead in north-eastern coastal states. This geographic area of America has historically, and consistently, been comprised of democratic-leaning states. This is the case because Democrats tend to gather a large percentage of the votes in big cities (@atlantic). The north-eastern coast includes many of these populous cities such as New York, Boston, Washington D.C. and Newark. As these cities have become more ethnically diverse, less manufacturing oriented and more educated over the years, the voter base has shifted towards the Democratic party (@atlantic). Like California on the west coast, these big east coast cities are focal points for incoming immigrants who tend to vote for the democratic party (@atlantic). As a result, the results from Figure 4 and 5 for north-eastern coastal states fall in line with prior voting behavior and tendencies.
 
In Figure 5, we see that Hispanic voters are more likely to vote for, democratic nominee, Joe Biden. As previously mentioned, the Republican’s willingness to pass Proposition 187 to restrict public services to illegal immigrants was poorly received by the Hispanic community, in particular (@krishnakumar). However, modern circumstances surrounding President Trump have also played a role in the aversion of the Hispanic community towards the Republican party. In the 2019 paper by Gutierrez et al., Gutierrez cites that Mexican Americans and immigrants felt threatened and targeted by Trump’s proposals and rhetoric (@gutierrez). Despite comments specifically targeting illegal immigrants from Mexico, a focus group in Florida composed of Puerto Rican voters noted that they feel Trump is villainizing the entire Latino population (@gutierrez). This could explain why Hispanic voters lean towards voting for Biden based on results seen in Figure 5. Gutierrez also follows-up by suggesting that the anger towards the 2016 election result, that saw Trump become president, could mobilize the Hispanic community to vote in greater numbers during the 2020 election (@gutierrez).

Based on our results, white voters have a strong propensity to vote for Trump in the 2020 election (Figure 3). This is important as white voters make up over 75% of the sample population and the post-stratification data (Figure 1). In the paper by Major et al., the researchers suggest that white voters are strongly supporting the Trump campaign as a result of the changing demographics in the United States (@major). As forecasted by the U.S. Census Bureau, the proportion of non-white individuals in the United States will be considerably higher than white individuals by the year 2060 (@us2012). When reminded of this projection, Major et al. reports that white voters with high ethnic identification became more concerned with their declining influence and have begun supporting Trump’s anti-immigration policies, as a result (@major). In contrast, our results show that black voters have a high propensity to vote for Biden (Figure 3). As suggested by researchers, this support is likely due to their resentment towards Trump. Trump’s opposition to the Black Lives Matter group and failure to condemn racism at key moments is viewed as threatening among African American voters (@towler). Black voters may represent a smaller percentage of the vote than white individuals, however, their support for Joe Biden has the potential to impact the election on a grand scale. 

Based on the polling data in Figure 1, male and female voting is nearly equal at 50%. However, our results suggest that men are more likely to vote for Republican nominee Trump, while women are more likely to vote for Democratic nominee Joe Biden (Figure 3). It is important to note that in the 2016 election, a significantly greater number of women voted in the election than men (@pewexam). Furthermore, 54% of women voted for the Hillary Clinton of the Democratic party @pewexam). This disposition to vote for the Democratic party has been staple of American women for the past 40 years. When president Raegan was nominated in 1980, the Republican party adopted right-leaning viewpoints on several issues relevant to women (@thompson_2020).  In particular, the Republican party began opposing abortion rights for women and ceased supporting the Equal Rights Amendment (@thompson_2020). Even though Raegan won that election, the decline of female voting support of the Republican party was commencing. This trend could serve as an explanation for the female support of Joe Biden in our results.

Contrary to classic convention, our results indicate that older individuals are progressively more likely to vote for Democratic nominee Joe Biden (Figure 3). One possible explanation for this change in voter behavior could be the Covid-19 outbreak that has plagued the entire world this year. As per the Centers for Disease Control and Protection, Covid-19 deaths are increasingly severe with age and disproportionately higher past the age of 55 (@cdc). As a result, the Covid-19 outbreak is viewed as a critical issue in this year’s election for the older percentage of voters (@pew). It is possible that Trump’s downplaying of the virus and refusal to wear a mask has upset the older voter population; culminating into Biden’s surprising lead over older individuals in our research (@cnn). In addition, these voters may be impressed with Biden’s plan to provide free testing to all Americans and financial support to those that lost their job due to the pandemic (@cnn).

Our results indicate that the higher education level completed, the more likely an individual will vote for Democratic nominee Joe Biden during the 2020 presidential election (Figure 3). A possible explanation for this general trend is that large, urban cities contain more universities and educational complexes compared to their rural counterparts. As a result, cities are more accessible for their inhabitants to complete higher levels of education. It is well understood that these large, urban cities tend to vote for the Democratic party while rural areas lean towards the Republican party (@atlantic). As such, Republican-leaning states in the rural, mid-west will naturally be inhabited by less educated individuals than the urban individuals living in Democrat-voting coastal states. 

We are very confident in our results for states that have coefficient estimates over 1.000 such as Massachusetts, Connecticut and Vermont to vote for Biden over Trump (Figure 3). In addition, we are also very confident in states that have coefficient estimates under 0.0 such as Idaho and Arkansas to vote for Trump over Biden (Figure 3). In contrast, we are not confident in the states that fall between these coefficient estimates as their polling results are incredibly close and various factors may tip the scales towards Republicans or Democrats when the election actually takes place. We are also not confident in states that have a standard error over 0.75 as there is a greater chance of inaccuracy for these states (Figure 3). In particular, we are not confident in the results of Alaska, Rhode Island, Wyoming and North Dakota (Figure 3).  

Considering the concurrences between our data results and the historical information we just outlined, we believe that Joe Biden will win the popular vote but ultimately lose the election through the electoral college. We believe Biden will gain the support of big city residents to win the popular vote but fail to make up ground in the rural, blue-collar mid-west that Trump had won in 2016. However, it is very possible that our prediction doesn’t hold due to the incredibly close results in certain states, such as Florida, Georgia and others **(Figure 4)**. In addition, considering the weaknesses and limitations of this study (Outlined in the next section), the validity of the data used in this research is subject to debate.

Lastly, we can take a look at the state of Ohio. Ohio has been one of the best predictors for who will win the presidential election. Ballotpedia calls the state a "bellwether" because since 1900, Ohio has voted for the winning candidate 93.33% of the time (@ballotpedia). This is a remarkable number and as seen in \@ref(fig:statemap), Ohio appears to be more red than blue which may give us evidence that although Biden won the popular vote, Trump may scrape out a victory.

## Weaknesses and Next Steps

   As seen in the 2016 election, the polls leading up to the presidential election can be inaccurate. Typically, this has not been an issue for the American polling companies. However, since becoming a presidential candidate, Donald Trump has become a polarizing figure in the media and among voters. As a result, it is very possible that some Trump voters are unwilling to show their support for the Republican candidate.
   
  In addition, 2020 has been plagued by the COVID-19 pandemic and has changed the landscape of the presidential election. Not only has it become a key concern for voters when deciding their next president, but the virus has also changed the campaigning procedures and influencing voting mediums. For example, democratic representative Joe Biden has been holding parking lot rallies where supporters are social distancing within their cars while showing their support. Likewise, Trump rallies have seen a lower number of supporters than his previous campaign trails. However, most importantly, voters are changing their approach for voting in relation to safety precautions regarding the pandemic. 91.6 million votes have already been cast through the mail to avoid coming in contact with others at the polling booths. As a result, this election is far from usual or predictable. Various aspects of the election are critically affected by the pandemic virus and in turn, the polling results from ACS should not be considered reliable or representative of the population as they may have been in previous years.

  A limitation of the survey dataset we are using is that it is from June 2020. As a result, the data is missing four months where voters may have changed their opinions and political allegiances. Healthcare, in particular, is an issue of very high importance for Americans during this election (@pew). As of September 2020, four Covid-19 vaccines have entered phase 3 of clinical trials and a vaccine may arrive by early 2021 (@nih). This kind of impactful development, among others, may influence voter behavior and alter the dataset if collected now.

  For future studies, we would suggest allocating more of the polling company budget towards examining the education level of individuals in order to get a better estimate of the results and gain a clearer picture of what the American population is leaning towards before the election. As seen in Figure 3, the estimate for this variable is not particularly strong in favor, nor against, voting for Joe Biden. In addition, there is little separating the estimates for the various categories of education level in our research.

# Code

Code supporting this analysis can be found at: https://github.com/matthewwankiewicz/US_election_forecast


